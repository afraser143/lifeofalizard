// Add these image loading sections at the start of your script
const images = {
    dragon: new Image(),
    worm: new Image(),
    fireBug: new Image(),
    waterBug: new Image(),
    earthBug: new Image(),
    superBug: new Image()
};

// Load all images
images.dragon.src = 'https://raw.githubusercontent.com/YOUR_USERNAME/YOUR_REPO/main/dragon.png';
images.worm.src = 'https://raw.githubusercontent.com/YOUR_USERNAME/YOUR_REPO/main/worm.png';
images.fireBug.src = 'https://raw.githubusercontent.com/YOUR_USERNAME/YOUR_REPO/main/firebug.png';
images.waterBug.src = 'https://raw.githubusercontent.com/YOUR_USERNAME/YOUR_REPO/main/waterbug.png';
images.earthBug.src = 'https://raw.githubusercontent.com/YOUR_USERNAME/YOUR_REPO/main/earthbug.png';
images.superBug.src = 'https://raw.githubusercontent.com/YOUR_USERNAME/YOUR_REPO/main/superbug.png';

// Modified drawing functions
function drawPlayer() {
    // If using images
    if (images.dragon.complete) {
        ctx.drawImage(images.dragon, player.x, player.y, player.width, player.height);
    } else {
        // Fallback to enhanced drawn version
        // Body
        ctx.fillStyle = '#D2691E'; // More vibrant brown
        ctx.fillRect(player.x, player.y, player.width, player.height);
        
        // Eyes
        ctx.fillStyle = 'black';
        ctx.beginPath();
        ctx.arc(player.x + player.width * 0.8, player.y + player.height * 0.3, 3, 0, Math.PI * 2);
        ctx.fill();
        
        // Beard
        ctx.fillStyle = '#8B4513';
        for(let i = 0; i < 5; i++) {
            ctx.beginPath();
            ctx.moveTo(player.x + player.width, player.y + player.height * (0.3 + i * 0.1));
            ctx.lineTo(player.x + player.width + 10, player.y + player.height * (0.35 + i * 0.1));
            ctx.lineTo(player.x + player.width, player.y + player.height * (0.4 + i * 0.1));
            ctx.fill();
        }
        
        // Scales
        ctx.fillStyle = '#A0522D';
        for(let i = 0; i < 3; i++) {
            for(let j = 0; j < 3; j++) {
                ctx.beginPath();
                ctx.arc(
                    player.x + player.width * (0.3 + i * 0.25),
                    player.y + player.height * (0.3 + j * 0.25),
                    2,
                    0,
                    Math.PI * 2
                );
                ctx.fill();
            }
        }
    }
}

function drawBug(bug) {
    const bugImage = images[`${bug.type}Bug`];
    if (bugImage.complete) {
        ctx.drawImage(bugImage, bug.x, bug.y, bug.width, bug.height);
    } else {
        // Enhanced fallback bug drawing
        ctx.fillStyle = bug.color;
        
        // Body
        ctx.beginPath();
        ctx.ellipse(
            bug.x + bug.width/2,
            bug.y + bug.height/2,
            bug.width/2,
            bug.height/3,
            0,
            0,
            Math.PI * 2
        );
        ctx.fill();
        
        // Wings or special features based on type
        switch(bug.type) {
            case 'fire':
                drawFireEffect(bug);
                break;
            case 'water':
                drawWaterEffect(bug);
                break;
            case 'earth':
                drawEarthEffect(bug);
                break;
            case 'super':
                drawSuperEffect(bug);
                break;
        }
    }
}

function drawEnemy(enemy) {
    if (images.worm.complete) {
        ctx.drawImage(images.worm, enemy.x, enemy.y, enemy.width, enemy.height);
    } else {
        // Enhanced worm drawing
        ctx.fillStyle = '#FF6B6B';
        
        // Segmented body
        for(let i = 0; i < 3; i++) {
            ctx.beginPath();
            ctx.arc(
                enemy.x + enemy.width * (0.3 + i * 0.25),
                enemy.y + enemy.height/2,
                enemy.height/3,
                0,
                Math.PI * 2
            );
            ctx.fill();
        }
        
        // Evil eyes
        ctx.fillStyle = 'black';
        ctx.beginPath();
        ctx.arc(enemy.x + enemy.width * 0.8, enemy.y + enemy.height * 0.3, 3, 0, Math.PI * 2);
        ctx.arc(enemy.x + enemy.width * 0.8, enemy.y + enemy.height * 0.7, 3, 0, Math.PI * 2);
        ctx.fill();
    }
}

// Add these helper functions for bug effects
function drawFireEffect(bug) {
    ctx.fillStyle = '#FFD700';
    for(let i = 0; i < 3; i++) {
        ctx.beginPath();
        ctx.moveTo(bug.x + bug.width/2, bug.y);
        ctx.lineTo(bug.x + bug.width * (0.2 + i * 0.3), bug.y - 5);
        ctx.lineTo(bug.x + bug.width * (0.3 + i * 0.3), bug.y);
        ctx.fill();
    }
}

function drawWaterEffect(bug) {
    ctx.fillStyle = '#87CEEB';
    ctx.beginPath();
    ctx.arc(bug.x + bug.width/2, bug.y + bug.height/2, bug.width/3, 0, Math.PI * 2);
    ctx.fill();
}

function drawEarthEffect(bug) {
    ctx.fillStyle = '#8B4513';
    for(let i = 0; i < 4; i++) {
        ctx.fillRect(
            bug.x + bug.width * (0.2 + i * 0.2),
            bug.y + bug.height * 0.8,
            3,
            3
        );
    }
}

function drawSuperEffect(bug) {
    ctx.fillStyle = '#FFD700';
    for(let i = 0; i < 5; i++) {
        const angle = (i * 72) * Math.PI / 180;
        ctx.beginPath();
        ctx.moveTo(bug.x + bug.width/2, bug.y + bug.height/2);
        ctx.lineTo(
            bug.x + bug.width/2 + Math.cos(angle) * bug.width/2,
            bug.y + bug.height/2 + Math.sin(angle) * bug.height/2
        );
        ctx.lineTo(
            bug.x + bug.width/2 + Math.cos(angle + 0.5) * bug.width/3,
            bug.y + bug.height/2 + Math.sin(angle + 0.5) * bug.height/3
        );
        ctx.fill();
    }
}

// Modify the drawGame function to use these new drawing functions
function drawGame() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    
    // Draw bugs
    bugs.forEach(bug => drawBug(bug));
    
    // Draw enemies
    enemies.forEach(enemy => drawEnemy(enemy));
    
    // Draw player
    drawPlayer();
}
